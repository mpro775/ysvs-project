# خطة تنفيذ الواجهة الأمامية (Frontend Execution Plan)

## مشروع منصة الجمعية اليمنية لجراحة الأوعية الدموية (YSVS)

**الإطار التقني:** React 19 (Vite) | TypeScript | Tailwind CSS
**مكتبة الواجهات:** Shadcn/ui (Radix UI)
**إدارة الحالة:** TanStack Query (Server State) + Zustand (Client State)
**النماذج:** React Hook Form + Zod

---

## 1. مرحلة التأسيس والبنية التحتية (Phase 1: Foundation)

قبل البدء بالشاشات، يجب تجهيز الأساس الذي يربط الفرونت بالباك إند.

### 1.1 إعداد المشروع (Setup)

* تهيئة مشروع **Vite** مع React 19 و TypeScript.
* تثبيت **Tailwind CSS** وتهيئة ملف `tailwind.config.js` بألوان الهوية البصرية للجمعية (الأزرق الطبي، الأبيض، الرمادي الهادئ).
* تثبيت مكونات **Shadcn/ui** الأساسية (Button, Input, Table, Dialog, Form, Toast).

### 1.2 طبقة الاتصال (API Layer)

* إعداد `Axios Instance` موحد:
  * **Request Interceptor:** لإرفاق `Authorization: Bearer Token` تلقائياً مع كل طلب.
  * **Response Interceptor:** لمعالجة هيكل الرد الموحد القادم من NestJS، واصطياد أخطاء `401 Unauthorized` لتوجيه المستخدم لصفحة الدخول.
* إعداد **TanStack Query Provider** لإدارة الكاش، إعادة المحاولة (Retry)، وحالة التحميل (Loading States).

### 1.3 التوجيه والحماية (Routing & Auth)

* استخدام **React Router v6.20+ (Data Router)**.
* إنشاء `ProtectedRoutes`: مكون يغلف لوحة التحكم ويتحقق من وجود التوكن وصلاحية `Role: Admin`.
* إنشاء `PublicRoutes`: للموقع العام.

---

## 2. الجزء الأول: لوحة التحكم الإدارية (Admin Dashboard)

**الأولوية:** عالية جداً (يجب بناؤها أولاً لإدخال البيانات).

### 2.1 الهيكل العام (Layout)

* **Sidebar:** قائمة جانبية قابلة للطي تحتوي على (الرئيسية، المؤتمرات، الأعضاء، الشهادات، الأخبار، البث، الإعدادات).
* **Top Bar:** يحتوي على معلومات الأدمن، زر تسجيل الخروج، وتبديل الوضع (Dark/Light Mode).
* **Breadcrumbs:** لتسهيل التنقل (مثلاً: الرئيسية > المؤتمرات > مؤتمر القلب).

### 2.2 وحدة إدارة المؤتمرات (Dynamic Event Manager)

هذا هو الجزء الأصعب والأكثر أهمية.

* **قائمة المؤتمرات:** جدول (TanStack Table) يعرض المؤتمرات مع خيارات (تعديل، حذف، مشاهدة المسجلين).
* **إضافة/تعديل مؤتمر:** نموذج متعدد الخطوات (Stepper):
  1. **البيانات الأساسية:** العنوان، الوصف، التواريخ، المكان.
  2. **باني نموذج التسجيل (Form Builder):**
     * واجهة تفاعلية تسمح للأدمن بإضافة حقول مخصصة.
     * زر "أضف حقل" -> يفتح نافذة لاختيار نوع الحقل (نص، ملف، اختيار) واسمه.
     * يتم تخزين هذا الهيكل كـ JSON `Schema` يرسل للباك إند.

### 2.3 وحدة إدارة المسجلين (Registrants Management)

* جدول يعرض أسماء الأطباء المسجلين في كل مؤتمر.
* إظهار البيانات الديناميكية (الأعمدة تتغير بناءً على نموذج التسجيل الخاص بالمؤتمر).
* زر **Export to Excel** (تكامل مع مكتبة `xlsx`).

### 2.4 وحدة الشهادات (Certificates Center)

* زر **Issue Certificates**: يقوم باستدعاء API التوليد الجماعي.
* عرض حالة الإصدار (تم الإصدار / قيد المعالجة).
* إمكانية البحث برقم الشهادة التسلسلي.

### 2.5 وحدة التحكم بالبث (Streaming Control)

* واجهة بسيطة تحتوي على:
  * Toggle Switch (Live / Offline).
  * Input Field: لوضع رابط البث (Youtube URL).
  * Preview: شاشة صغيرة تعرض كيف سيظهر البث في الموقع.

---

## 3. الجزء الثاني: الموقع العام (Public Website)

**الأولوية:** عالية (واجهة الجمهور).

### 3.1 الصفحة الرئيسية (Home Page)

* **Hero Section الذكي:**
  * يستعلم من `useQuery` عن حالة البث (`/stream/status`).
  * إذا `isLive === true`: يعرض مشغل الفيديو فوراً.
  * إذا `false`: يعرض سلايدر الصور التعريفية.
* **العداد التنازلي:** مكون يحسب الوقت المتبقي لأقرب مؤتمر قادم.
* **أحدث الأخبار:** شبكة (Grid) تعرض آخر 3 مقالات.

### 3.2 صفحة تفاصيل المؤتمر والتسجيل (Single Event)

* عرض تفاصيل المؤتمر (Tabs: نبذة، المتحدثون، الجدول).
* **نموذج التسجيل الديناميكي (The Dynamic Renderer):**
  * هذا المكون يستقبل الـ JSON Schema من الباك إند.
  * يقوم بعمل `Loop` ويرسم الحقول (Inputs) المناسبة.
  * يستخدم `React Hook Form` لجمع البيانات والتحقق منها (Client-side Validation) قبل الإرسال.

### 3.3 بوابة الطبيب (Member Portal)

* **تسجيل الدخول/إنشاء حساب:** نماذج بسيطة وواضحة.
* **لوحة الطبيب:**
  * **سجل المؤتمرات:** قائمة بالمؤتمرات التي سجل فيها وحالة الحضور.
  * **محفظة الشهادات:** بطاقات تعرض الشهادات الحاصل عليها زر "تحميل PDF".

### 3.4 صفحة التحقق (Verification Page)

* المسار: `/verify/:serialNumber`
* تقوم بقراءة البارامتر من الرابط تلقائياً.
* تستدعي الباك إند للتحقق.
* تعرض بطاقة خضراء (شهادة موثقة) وتفاصيلها، أو حمراء (غير صالحة).

---

## 4. التحسين والأداء (Optimization)

* **Code Splitting:** استخدام `React.lazy` و `Suspense` لتحميل لوحة التحكم بشكل منفصل عن الموقع العام، لتقليل حجم ملف الـ JavaScript الأولي للزوار.
* **Image Optimization:** إنشاء مكون `Img` مخصص يتعامل مع الصور، ويضع `placeholder` أثناء التحميل.
* **SEO:** استخدام `React Helmet Async` لإدارة العناوين والوصف (Meta Tags) ديناميكياً لكل مقال ومؤتمر.

---

## 5. الجدول الزمني للتنفيذ (Frontend Roadmap)


| الأسبوع | المهمة                                               | المخرجات المتوقعة                                                                 |
| :------------- | :--------------------------------------------------------- | :------------------------------------------------------------------------------------------------ |
| **1**          | إعداد المشروع + Auth + Layouts                 | هيكل المشروع، تسجيل الدخول، وتصميم القائمة الجانبية. |
| **2**          | لوحة التحكم (المؤتمرات + Form Builder)  | إمكانية إضافة مؤتمر وبناء نموذج التسجيل الخاص به.        |
| **3**          | الموقع العام (Home + Dynamic Forms)             | عرض الموقع للزوار وإتاحة التسجيل في المؤتمرات.             |
| **4**          | بوابة الأعضاء + الشهادات + البث    | بروفايل الطبيب، تحميل الشهادات، وتفعيل البث.                |
| **5**          | الربط النهائي + التحسينات (UI Polish) | اختبار شامل، تحسين التصميم، ومعالجة الملاحظات.            |

---

*تضمن هذه الخطة بناء واجهة أمامية حديثة، سريعة الاستجابة، وتوفر تجربة مستخدم (UX) ممتازة للإدارة والأطباء على حد سواء.*
